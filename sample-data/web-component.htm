<script>
  const template = document.createElement('template');
  template.innerHTML = `
<style>
:host {
  margin-bottom: 10px;
  display: grid;
  grid-template-areas: "t t t" "l m r" "b b b";
  grid-template-columns: 5% 90% 5%;
  grid-template-rows: 5% 90% 5%;
  grid-gap: 0;
  font-family: sans-serif;
}

* {
  box-sizing: border-box;
}

#field {
  display: grid;
  grid-template-areas: "a";
  gap: 1px;
  grid-area: m;
  border: 1px solid grey;
}

.field {
  background-color: lime;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

.field:hover {
  background: darkgreen;
}

.field.selected {
  color: silver;
  background: darkred;
}

.field.selected:hover {
  background: red;
}

#label-top {
  grid-area: t
}

#label-bottom {
  grid-area: b
}

#label-left {
  grid-area: l
}

#label-right {
  grid-area: r
}

#label-left,
#label-right,
#label-top,
#label-bottom {
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: x-small;
}

#label-left-content {
  white-space: nowrap;
  transform: rotate(-90deg);
}

#label-right-content {
  transform: rotate(90deg);
  white-space: nowrap;
}
</style>
<div id="label-top"><span id="label-top-content"></span></div>
<div id="label-left"><span id="label-left-content"></span></div>
<div id="field"></div>
<div id="label-right"><span id="label-right-content"></span></div>
<div id="label-bottom"><span id="label-bottom-content"></span></div>
`;

  class FormField extends HTMLElement {
    constructor() {
      super();
      this._shadowRoot = this.attachShadow({
        'mode': 'open'
      });
      this._shadowRoot.appendChild(template.content.cloneNode(true));
      this.$field = this.shadowRoot.querySelector("#field");
      this.$labelTop = this.shadowRoot.querySelector("#label-top-content");
      this.$labelBottom = this.shadowRoot.querySelector("#label-bottom-content");
      this.$labelLeft = this.shadowRoot.querySelector("#label-left-content");
      this.$labelRight = this.shadowRoot.querySelector("#label-right-content");
      this.$style = this.shadowRoot.querySelector("style");
      this.labels = '';
    }
    static get observedAttributes() {
      return [
        "size",
        "label-top",
        "label-bottom",
        "label-left",
        "label-right",
        "labels",
        "value",
        "name",
        "inner-style"
      ];
    }
    attributeChangedCallback(name, oldValue, newValue) {
      switch (name) {
        case "size":
          this._createFields(newValue);
          break;
        case "labels":
          try {
            this.labels = JSON.parse(newValue);
          } catch (e) {
            this.labels = '';
          }
          this._updateFieldLabels();
          break;
        case "label-top":
          this.$labelTop.innerText = newValue;
          break;
        case "label-bottom":
          this.$labelBottom.innerText = newValue;
          break;
        case "label-left":
          this.$labelLeft.innerText = newValue;
          break;
        case "label-right":
          this.$labelRight.innerText = newValue;
          break;
        case "inner-style":
          this.$style.innerHTML += newValue;
          break;
        case "value":
        default:
          this._updateValue(newValue);
          break;
      }
    }
    _createFields(size) {
      this.$field.innerText = '';
      this.$field.style.gridTemplateAreas = '"' + Array.from({ length: size }).map(_ => 'a').join(' ') + '"';
      const to = (Math.floor(size / 2));
      const from = -1 * to;
      const isOdd = !!(size % 2);
      for (let i = from; i <= to; i++) {
        if (!isOdd && !i) continue;
        for (let j = from; j <= to; j++) {
          if (!isOdd && !j) continue;
          this.$field.appendChild(this._createField(i, j));
        }
      }
    }
    _createField(x, y) {
      const field  = document.createElement('div');
      field.className = 'field';
      field.dataset.value = this._getFieldValue(x, y);
      field.innerText = this._getFieldLabel(x, y);
      field.addEventListener('click', () => {
        this._updateValue(field.dataset.value);
      });
      return field;
    }
    _getFieldValue(x, y) {
      return `${x}, ${y}`;
    }
    _getCoordinatesFromValue(fieldValue) {
      return fieldValue.split(',').map(s => parseInt(s.trim()));
    }
    _getFieldLabel(x, y) {
      if (this.labels.length) {
        if (this.labels[x] && this.labels[x][y]) {
          return this.labels[x][y];
        } else {
          return "";
        }
      }
      return this._getFieldValue(x, y);
    }
    _updateValue(value) {
      this.$field.querySelectorAll('.field.selected')
        .forEach(field => field.classList.remove('selected'));
      const selectedField = this.$field.querySelector(`.field[data-value="${value}"]`);

      if (!selectedField) {
        console.warn("invalid value", value);
        // todo invalid
        return;
      }
      selectedField.classList.add('selected');

      this.value = value;
    }
    _updateFieldLabels() {
      console.log('l', this.labels);
      this._shadowRoot.querySelectorAll(`.field`)
        .forEach(field => {
          if (!field.dataset) {
            console.log('f', field);
            return;
          }
          const xy = this._getCoordinatesFromValue(field.dataset.value);
          field.innerText = this._getFieldLabel(...xy)
        });
    }
  }
  window.customElements.define('db-form-field', FormField);
</script>

<h1>Custom Web-Element</h1>
<db-form-field
    size="5"
    label-top="top"
    label-left="left"
    label-right="right"
    label-bottom="bottom"
    name="yolo"
    value="0, 0"
    labels=""
    style="height: 400px; width: 400px"
></db-form-field>
<hr>
<db-form-field
    size="4"
    label-top="top"
    label-left="left"
    label-right="right"
    label-bottom="bottom"
    name="yolo2"
    value="1, 1"
    style="height: 500px; width: 500px"
></db-form-field>
<db-form-field
    id="other-color"
    size="10"
    label-top="top"
    label-left="left"
    label-right="right"
    label-bottom="bottom"
    name="yolo2"
    value="1, 1"
    style="height: 500px; width: 500px; background: black; color: white"
    inner-style=".field { background: orange; color: black }",
    labels='[[], ["A", "B"]]'
></db-form-field>